# Print a secret from sops file
# Usage: print-secret <secret_name> [sops_file]

KEY_NAME="$1"
SOPS_FILE="${2:-secrets.yaml}"

if [ -z "$KEY_NAME" ]; then
    echo "Usage: $(basename "$0") <secret_name> [sops_file]"
    exit 1
fi

if [ ! -f "$SOPS_FILE" ]; then
  echo "Error: $SOPS_FILE not found."
  exit 1
fi

# Constructing path with robust quoting: '["' + $KEY_NAME + '"]'
EXTRACT_PATH='["'$KEY_NAME'"]'

# Extract and print to stdout
@sops@ --extract "$EXTRACT_PATH" -d "$SOPS_FILE"
